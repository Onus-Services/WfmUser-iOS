name: Generate Folder Name
on:
  workflow_call:
    outputs:
      folder_name:
        description: "Generated folder name"
        value: ${{ jobs.generate.outputs.folder_name }}

jobs:
  generate:
    runs-on: self-hosted
    outputs:
      folder_name: ${{ steps.set-folder-name.outputs.folder_name }}
    steps:

      - name: Read version and build from Xcode settings
        id: set-folder-name
        run: |
          VERSION=$(xcodebuild -project WfmUser.xcodeproj -scheme WfmUser -showBuildSettings | grep MARKETING_VERSION | awk '{print $3}')
          BUILD=$(xcodebuild -project WfmUser.xcodeproj -scheme WfmUser -showBuildSettings | grep CURRENT_PROJECT_VERSION | awk '{print $3}')
          FOLDER_NAME="v${VERSION}_${BUILD}"
          echo "📁 Version: $VERSION"
          echo "📦 Build: $BUILD"
          echo "📂 Folder Name: $FOLDER_NAME"
          echo "folder_name=$FOLDER_NAME" >> $GITHUB_OUTPUT
         
